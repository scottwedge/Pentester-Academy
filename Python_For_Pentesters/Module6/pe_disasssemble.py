import pydasm
import pefile

def get_section(pe,start):
    for section in pe.sections:
        if section.contains_rva(start):
            return section

pe = pefile.PE('C:\\Windows\\notepad.exe')

start = pe.OPTIONAL_HEADER.AddressOfEntryPoint

section = get_section(pe,start)

shellcode = section.get_data(start,200)
offset = 0

while offset < len(shellcode):

    instruction = pydasm.get_instruction(shellcode[offset:],pydasm.MODE_32)
    print pydasm.get_instruction_string(instruction,pydasm.FORMAT_INTEL,0)
    
    if not instruction :
        offset+=1
        continue

    offset+=instruction.length
