from scapy.all import *
import sys

def filterHTTP(packet):
    if packet.haslayer(Raw) and (packet.dport == 80 or packet.sport == 80):
        p = str(packet["Raw"])
        if "GET" in p:
            print p
        elif "POST" in p:
            print p

while True:
    try:
        print "Sniffer in Scapy started"
        pkts = sniff(iface="wlan0",filter="tcp and (port 80 or port 443)",prn = filterHTTP)
    except KeyboardInterrupt:
        print "Exiting......"
        sys.exit()
