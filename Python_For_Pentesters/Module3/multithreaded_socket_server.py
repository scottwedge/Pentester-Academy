import SocketServer
import threading
import os
import sys

class EchoServer(SocketServer.BaseRequestHandler):

    def handle(self):
        data = "dummy"
        while len(data):
            data = self.request.recv(1024)
            print "Client sent: "+data
            self.request.send(data)

class ThreadedTCPServer(SocketServer.ThreadingMixIn,SocketServer.TCPServer):
    pass

addr = ("0.0.0.0",int(sys.argv[1]))

server = ThreadedTCPServer(addr,EchoServer)

t = threading.Thread(target=server.serve_forever())
t.daemon = True
t.start()

server.shutdown()
server.server_close()
