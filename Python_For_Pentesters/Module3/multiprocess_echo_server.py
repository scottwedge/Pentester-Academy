import sys
from multiprocessing import Process


def EchoSever(client,addr):
    while 1:
        data = client.recv(1024)
        if data:
            client.send(data)
        else:
            client.close()
            return

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.bind(('0.0.0.0',int(sys.argv[1]))
s.listen(2)
threads=[]

while 1:
    client,addr = s.accept()
    thread = Process(target = EchoServer, args = ((client,addr)))
    thread.start()
    thread.append(thread)
