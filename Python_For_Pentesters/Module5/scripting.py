import immlib
import sys

DESC = "Playing with process"

def main(args):

    imm = immlib.Debug()
    imm.Log("Writing to Log files!")
    imm.updateLog()
    #imm.openProcess("C:\\Users\\root\\Downloads\\Server-Strcpy")
    imm.Attach(int(args[0]))
    moduleList = imm.getAllModules()
    td = imm.createTable("Module Information",['Name','Base','Entery','Version'])
    for entity in modulesList.values():
        td.add(0,[entity.getName(),
               '%08X' %entity.getBaseAddress(),
               '%08X' %entity.getEntery(),
               '%08X' %entity.getSize(),
               entity.getVersion()
               ])

    imm.log(str(get.Regs()))
    return "[+] Success!"
    
    #pslist = imm.ps()
